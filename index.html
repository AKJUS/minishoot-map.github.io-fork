<!DOCTYPE HTML>
<html>
    <head>
        <title>Minishoot' Adventures map</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
#map-cont {
    flex-grow: 1;
    overflow: hidden;
}
#view {
    transform-origin: top left;
    position: relative;
}
body {
    --size: calc(var(--dd) * 1px);
}
.mark {
    position: absolute;
    --size-fac: 1;
}
.mark > img {
    user-select: none;
    display: block;
    object-fit: contain;
    width: var(--size);
    height: var(--size);
    transform: translate(-50%, -50%) scale(calc(var(--size2) * var(--size-fac)));
}
.dot {
    display: inline-block;
    width: 100%;
    height: 100%;
    background: #ff00ff;
    border-color: #ff00ff;
    border-radius: 50%;
}

.overworld {
    position: absolute;
    transform-origin: top left;
}
.d3 {
    position: absolute;
    transform-origin: top left;
}
.selected.mark, .selected .mark {
    z-index: 2;
}
.selected.mark::before, .selected .mark {
    content: "";
    position: absolute;
    width: var(--size);
    height: var(--size);
    transform: translate(-50%, -50%) scale(calc(var(--size2) * var(--size-fac)));
    outline: calc(30px / var(--size-fac)) solid red;
}
.collider {
    display: inline-block;
    position: absolute;
}
.collider > svg {
    position: absolute;
}

.gap {
    display: inline-block;
    width: 1rem;
}

.wrapper {
    width: 100%;
    height: 98vh;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
#views {
    flex-grow: 1;
    max-width: 100%;
    max-height: 100%;
}

#views > * {
    background: white;
}

#prop {
    overflow-y: scroll;
}

.off {
    margin-left: 0.5rem;
}

.batch {
    position: absolute;
}

@media not (orientation: portrait) {
#prop-show-hide {
    display: none;
}
#views {
    display: flex;
    flex-direction: row;
}
}

@media(orientation: portrait) {
#prop-show-hide {
    display: block;
    text-align: center;
    padding: 0.5rem;
    background: #80808020;
    border: none;
}
#views {
    position: relative;
}
#views > * {
    position: absolute;
    top: 0px;
    left: 0px;
    right: 0px;
    bottom: 0px;
}
#views[data-hidden="true"] #prop {
    display: none;
}
}

#center-view {
    position: relative /* absolute breaks everything for some reason (scrollbars, map on top of everything) */;
    top: 50%;
    left: 50%;
    width: 0px;
    height: 0px;
}

</style>
    </head>
    <body>
        <div class="wrapper">
            <button id="prop-show-hide">properties</button>
            <div id="views">
                <div id="map-cont">
                    <div id="center-view">
                        <div id="view">
                            <div id="maps" style="user-select: none">
                                <img id="ow" src="overworld.png" class="overworld"  draggable="false">
                                <img id="d3" src="d3.png" class="d3" draggable="false">
                            </div>
                        </div>
                    </div>
                </div>
                <div id="prop" style="border-left: 1px solid gray; padding: 0.2rem; min-width: 15rem">
                    <div style="display: flex; flex-direction: column; gap: 1rem">
                        <div>
                            Selected: <input id="name" type="text" style="display: inline-block; min-width: 5rem"></input>
                            <button id="goto-mark">focus</button>
                            <br>
                            <div id="desc"></div>
                        </div>
                        <div id="c-enemy" style="display: none">
                            Enemy:
                            <div class="off">
                                <div class="desc"></div>
                                XP for level <input class="lvl" type="number" style="width: 2rem;">: <span class="xp" style="display: inline-block; min-width: 3rem"></span>
                            </div>
                        </div>
                        <div id="c-jar" style="display: none">
                            Jar:
                            <div class="off">
                                <div class="desc"></div>
                            </div>
                        </div>
                        <div id="c-crd" style="display: none">
                            CrystalDestroyable:
                            <div class="off">
                                <div class="desc"></div>
                            </div>
                        </div>
                        <div id="c-tran" style="display: none">
                            Transition:
                            <div class="off">
                                <div class="desc"></div>
                            </div>
                        </div>
                        <div id="c-scarab" style="display: none">
                            Scarab:
                            <div class="off">
                                Destroyable: <span class="dest"></span>
                            </div>
                        </div>
                        <div id="c-destr" style="display: none">
                            Destroyable:
                            <div class="off">
                                Permanent: <span data-perm></span>
                            </div>
                        </div>
                        <div>
                            Other markers nearby:<br>
                            <div id="other" class="off"></div>
                        </div>
                    </div>
                    <div>
                        <hr>
                        <input type="checkbox" id="e-f">Show enemies:<br>
                        <span class="gap"></span><input type="checkbox" id="e-f-name">Filter by name containing <input type="text" style="width: 3rem" id="e-f-name-text"><br>
                        <span class="gap"></span><input type="checkbox" id="e-f-size">Filter by size <input type="number" style="width: 3rem" id="e-f-size-text"><br>
                        <span class="gap"></span><input type="checkbox" id="e-f-tier">Filter by tier <input type="number" style="width: 3rem" id="e-f-tier-text"><br>
                        <input type="checkbox" id="j-f">Show jars:<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-0">Drops nothing<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-1">Drops hp<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-2">Drops random<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-3">Drops big crystal<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-4">Drops enegry<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-5">Drops full energy<br>
                        <span class="gap"></span><input type="checkbox" id="j-f-6">Drops 65 big crystals<br>
                        <input type="checkbox" id="crd-y-f">Show crystals (xp):<br>
                        <input type="checkbox" id="crd-n-f">Show crystals (no xp):<br>
                        <span class="gap"></span><input type="checkbox" id="crd-f-s">Filter by size <input type="number" style="width: 3rem" id="crd-f-s-text"><br>
                        <input type="checkbox" id="tran-f">Show transitions<br>
                        <span class="gap"></span><input type="checkbox" id="tran-f-l">Show transtion destination lines<br>
                        <input type="checkbox" id="scarab-f">Show scarabs<br>
                        <input type="checkbox" id="c-f">Show environment colliders:<br>
                        <span class="gap"></span><input type="checkbox" id="c-f-16">Hole (16)<br>
                        <span class="gap"></span><input type="checkbox" id="c-f-4">Water (4)<br>
                        <span class="gap"></span><input type="checkbox" id="c-f-6">Deep water (6)<br>
                        <span class="gap"></span><input type="checkbox" id="c-f-14">Walls (14)<br>
                        <span class="gap"></span><input type="checkbox" id="c-f-25">Bridge (25)<br>
                        <span class="gap"></span><input type="checkbox" id="c-f-17">Trigger (17)<br>
                        <input type="checkbox" id="b-f">Show backgrounds<br>
                    </div>
                </div>
            </div>
        </div>

        <script>
            var wereObjectsLoaded = false
            var objectsLoadedS, objectsLoadedJ
            var objectsLoaded = new Promise((s, j) => {
                objectsLoadedS = () => {
                    wereObjectsLoaded = true
                    s()
                }
                objectsLoadedJ = j
            })
        </script>
        <script async src="data/objects.js" onload="objectsLoadedS()" onerror="objectsLoadedJ()"></script>

        <script src="collider_view.js"></script>
        <script src="display.js"></script>
    </body>
</html>
